<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Spike</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 2px; background-color: #ffffff; color: #000000; margin: 0; }
    .left-column { position: fixed; top: 0; left: 0; width: 80px; height: 600px; display: flex; flex-direction: column; justify-content: space-around; align-items: center; background-color: #f5f5f5; border-right: 1px solid #ccc; box-sizing: border-box; }
    .emoji-block { display: flex; flex-direction: column; justify-content: space-around; align-items: center; height: 100%; margin-top: 20px; }
    .emoji-container { display: flex; flex-direction: column; align-items: center; margin-bottom: 15px; }
    .emoji-container button { font-size: 32px; cursor: pointer; border: none; background: none; transition: transform 0.15s ease, filter 0.15s ease; }
    .emoji-container button:hover { transform: scale(1.08); filter: brightness(110%); }
    .emoji-label { margin-top: 5px; font-size: 12px; color: black; text-align: center; width: 60px; word-wrap: break-word; }

    .snippet-column { margin-left: 100px; padding: 10px; }
    .snippet { border: none; border-radius: 8px; padding: 6px; margin: 8px 0; background-color: #f9f9f9; width: 100%; box-sizing: border-box; }
    .snippet button { cursor: pointer; padding: 6px 10px; font-size: 20px; border-radius: 6px; border: 1px solid rgba(0,0,0,0.15); color: #ffffff; display: inline-flex; align-items: center; justify-content: center; transition: transform 0.12s ease, filter 0.12s ease; }
    .snippet button:hover { transform: scale(1.05); filter: brightness(110%); }
    .snippet .emoji { font-size: 1.3em; }
  </style>
</head>
<body>
  <div class="left-column">
    <div class="emoji-block">
      <div class="emoji-container"><button onclick="refreshSnippets(1)">ðŸ”µ</button><div class="emoji-label">Motors</div></div>
      <div class="emoji-container"><button onclick="refreshSnippets(2)">ðŸ”´</button><div class="emoji-label">Movement</div></div>
      <div class="emoji-container"><button onclick="refreshSnippets(3)">ðŸŸ£</button><div class="emoji-label">Light</div></div>
      <div class="emoji-container"><button onclick="refreshSnippets(4)">ðŸŸ¡</button><div class="emoji-label">Events</div></div>
      <div class="emoji-container"><button onclick="refreshSnippets(5)">ðŸŸ¡</button><div class="emoji-label">Control</div></div>
      <div class="emoji-container"><button onclick="refreshSnippets(6)">ðŸ”µ</button><div class="emoji-label">Sensors</div></div>
      <div class="emoji-container"><button onclick="refreshSnippets(7)">ðŸŸ¢</button><div class="emoji-label">Operators</div></div>
      <div class="emoji-container"><button onclick="refreshSnippets(8)">ðŸ”´</button><div class="emoji-label">My Block</div></div>
    </div>
  </div>

  <div class="snippet-column" id="snippet-column">
    <!-- Snippets will be dynamically inserted here -->
  </div>

  <script>
    const snippetData = {
      1: { snippets: [ // Motors
        { id: "snippet1", buttonText: 'Run shortest distance to absolute 0', color: '#0000FF', emoji: 'ðŸ§¿', 
         textComment: '# Run shortest distance to absolute 0',
         textPython: "await motor.run_to_absolute_position(port.E, 0, 200, direction=motor.SHORTEST_PATH)" }
      ] }, // Motor
      2: { snippets: [ // Movement
        { id: "snippet1", buttonText: 'Forward 20cm 25% velocity', color: '#FF4CCD', emoji: 'ðŸ§¿',
         textComment: '# Forward 20cm 25% velocity',
         textPython: "await motor_pair.move_for_degrees(motor_pair.PAIR_1, 20*21, 0, velocity=int(.25*1100))" },
        
        { id: "snippet2", buttonText: 'Backward 20cm 25% velocity', color: '#FF4CCD', emoji: 'ðŸ§¿',
         textComment: '# Backward 20cm 25% velocity',
         textPython: "await motor_pair.move_for_degrees(motor_pair.PAIR_1, -20*21, 0, velocity=int(.25*1100))" },
        
        { id: "snippet3", buttonText: 'Tank Turn Right 90 degrees', color: '#FF4CCD', color: '#FF4CCD' , emoji: 'ðŸ§¿',
         textComment: '# Tank Turn Right 90 degrees', textPython: "await motor_pair.move_for_degrees(motor_pair.PAIR_1, 180, 100)"},
        
        { id: "snippet4", buttonText: 'Tank Turn Left 90 degrees', color: '#FF4CCD', color: '#FF4CCD' , emoji: 'ðŸ§¿',
         textComment: '# Tank Turn Left 90 degrees', textPython: "await motor_pair.move_for_degrees(motor_pair.PAIR_1, -180, 100)"},
        
        { id: "snippet5", buttonText: 'Pivot Turn Right 90 degrees', color: '#FF4CCD', color: '#FF4CCD' , emoji: 'ðŸ§¿',
         textComment: '# Pivot Turn Right 90 degrees', textPython: "await motor_pair.move_for_degrees(motor_pair.PAIR_1, 360, 50)"},
        
        { id: "snippet6", buttonText: 'Pivot Turn Left 90 degrees', color: '#FF4CCD', color: '#FF4CCD' , emoji: 'ðŸ§¿',
         textComment: '# Pivot Turn Left 90 degrees', textPython: "await motor_pair.move_for_degrees(motor_pair.PAIR_1, -360, 50)"},
       
        { id: "snippet7", buttonText: 'Stop Moving', color: '#FF4CCD', emoji: 'ðŸ§¿', 
         textComment: '# Stop moving', textPython: "motor_pair.stop(motor_pair.PAIR_1)" }
      ] }, // Movement
      3: { snippets: [ 
        { id: "snippet1", buttonText: 'Turn On Smiley Face', color: '#544AAC', emoji: 'ðŸ§¿', 
         textComment: '# Turn On Smiley Face',
         textPython: "light_matrix.show_image(light_matrix.IMAGE_SMILE)" },
        { id: "snippet2", buttonText: 'Turn On Smiley Face For 2 Seconds', color: '#544AAC', emoji: 'ðŸ§¿', 
         textComment: '# Turn On Smiley Face For 2 Seconds',
         textPython: "light_matrix.show_image(light_matrix.IMAGE_SMILE)"  + '\n' + "sleep(2)"},
        { id: "snippet3", buttonText: 'Turn On Angry Face', color: '#544AAC', emoji: 'ðŸ§¿', 
         textComment: '# Turn On Angry Face',
         textPython: "light_matrix.show_image(light_matrix.IMAGE_ANGRY)" },
        { id: "snippet4", buttonText: 'Turn On Angry Face For 2 Seconds', color: '#544AAC', emoji: 'ðŸ§¿', 
         textComment: '# Turn On Angry Face For 2 Seconds',
         textPython: "light_matrix.show_image(light_matrix.IMAGE_ANGRY)"  + '\n' + "sleep(2)"}
      ] }, // Light
      4: { snippets: [ // control
        { id: "snippet1", buttonText: 'Wait for 1 seconds', color: '#E7AF35', emoji: 'ðŸ§¿', 
         textComment: '# Wait for 1 second',
         textPython: "sleep(1)" }
      ] }, // Control
      5: { snippets: [ // events
        { id: "snippet1", buttonText: 'Wait For Force Sensor Pressed', color: '#E0C83C', emoji: 'ðŸ§¿', 
         textComment: '# Wait For Force Sensor Pressed',
         textPython: "while force_sensor.force(port.A) < 1: pass"}
      ] }  // Envent
    };

    function refreshSnippets(buttonId) {
      const column = document.getElementById('snippet-column');
      column.innerHTML = '';

      const data = snippetData[buttonId];
      if (!data) return;

      data.snippets.forEach((snippet, index) => {
        const snippetDiv = document.createElement('div');
        snippetDiv.className = 'snippet movement';

        const preId = `snippet-${buttonId}-${index}`;
        const pre = document.createElement('pre');
        pre.id = preId;
        pre.contentEditable = true;
        pre.style.display = 'none';
        pre.textContent = '\n' + snippet.textComment + '\n' + snippet.textPython + '\n';

        snippetDiv.appendChild(pre);

        const button = document.createElement('button');
        button.innerHTML = `<span class="emoji">${snippet.emoji}</span> ${snippet.buttonText}`;
        button.style.backgroundColor = snippet.color;
        button.style.color = '#ffffff';
        button.addEventListener('click', () => copySnippetWithLineInsert(preId));

        snippetDiv.appendChild(button);
        column.appendChild(snippetDiv);
      });
    }

    function copySnippetWithLineInsert(preId) {
      const el = document.getElementById(preId);
      if (!el) {
        console.warn(`copySnippetWithLineInsert: element with id ${preId} not found`);
        alert('Snippet not available to copy. Try clicking the emoji in the left column to reload snippets.');
        return;
      }

      const text = el.textContent || '';
      const indentedText = text.replace(/^/gm, '    ');

      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(indentedText).catch(err => { fallbackCopy(indentedText); });
      } else {
        fallbackCopy(indentedText);
      }
    }

    function fallbackCopy(text) {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'absolute';
      textarea.style.left = '-9999px';
      document.body.appendChild(textarea);
      textarea.select();
      try { document.execCommand('copy'); } catch (e) { console.error('fallback copy failed', e); }
      document.body.removeChild(textarea);
    }

    document.addEventListener('DOMContentLoaded', () => refreshSnippets(1));
  </script>
</body>
</html>
